// Sandbox functionality test
// This test exercises each restricted operation

print("Testing sandbox restrictions...\n");

// Test 1: File write
print("Test 1: File write");
try {
    let f = open("/tmp/sandbox_test.txt", "w");
    f.write("test");
    f.close();
    print("  -> ALLOWED\n");
} catch (e) {
    print("  -> BLOCKED: " + e + "\n");
}

// Test 2: File read
print("Test 2: File read");
try {
    let f = open("/etc/hostname", "r");
    let content = f.read();
    f.close();
    print("  -> ALLOWED\n");
} catch (e) {
    print("  -> BLOCKED: " + e + "\n");
}

// Test 3: Process execution
print("Test 3: Process exec");
try {
    exec("echo hello");
    print("  -> ALLOWED\n");
} catch (e) {
    print("  -> BLOCKED: " + e + "\n");
}

// Test 4: Network socket
print("Test 4: Network socket");
try {
    // AF_INET=2, SOCK_STREAM=1
    let sock = socket_create(2, 1, 0);
    if (sock != null) {
        socket_close(sock);
        print("  -> ALLOWED\n");
    } else {
        print("  -> FAILED to create\n");
    }
} catch (e) {
    print("  -> BLOCKED: " + e + "\n");
}

print("\nDone.\n");
