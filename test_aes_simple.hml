import { generate_aes_key, generate_iv, aes_encrypt, aes_decrypt } from "@stdlib/crypto";

print("Test 1: Generate key and IV");
let key = generate_aes_key();
let iv = generate_iv();
print("key type: " + typeof(key));
print("iv type: " + typeof(iv));

print("\nTest 2: Encrypt");
let plaintext = "Hello";
print("plaintext: '" + plaintext + "'");
print("key length: " + typeof(key.length));
print("iv length: " + typeof(iv.length));
let ciphertext = aes_encrypt(plaintext, key, iv);
print("ciphertext type: " + typeof(ciphertext));
print("ciphertext length: " + typeof(ciphertext.length));

print("\nTest 3: Decrypt");
try {
    let decrypted = aes_decrypt(ciphertext, key, iv);
    print("decrypted type: " + typeof(decrypted));
    print("decrypted value: '" + decrypted + "'");

    if (decrypted == plaintext) {
        print("✓ SUCCESS: Decrypted matches plaintext!");
    } else {
        print("✗ FAIL: Decrypted doesn't match");
        print("  Expected: '" + plaintext + "'");
        print("  Got: '" + decrypted + "'");
    }
} catch (e) {
    print("ERROR during decryption: " + e);
}
